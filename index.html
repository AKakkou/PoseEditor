<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>PoseEditor</title>

        <script src="bower_components/three.js/three.js" type="text/javascript"></script>
        <script src="build/poseeditor.js" type="text/javascript"></script>
        <script src="ext/TransformControls.js" type="text/javascript"></script>
        <script src="ext/OrbitControls.js" type="text/javascript"></script>

        <script src="http://code.jquery.com/jquery-2.1.1.js" type="text/javascript"></script>
    </head>
    <body>
        <div id="for_pose" style="width: 100%; height: 400px;"></div>

        <script type="text/javascript">
         var editor = null;

         function downloadImage() {
           // basic example
           if ( editor != null ) {
             var a = document.createElement("a");
             a.download = name;
             a.title = "download snapshot";

             var radio = document.getElementsByName("format");
             var format = "";
             for(var i=0; i<radio.length; i++) {
               if (radio[i].checked) {
                 format = radio[i].value
                 break;
               }
             }

             a.href = editor.toDataUrl(format);
             a.click();

             delete a;
           }
         }

         function loadSceneData() {
           // basic example
           if ( editor != null ) {
             var dom = document.getElementById("scene_data");
             editor.loadSceneDataFromString(dom.value);
           }
         }

         function toggleMarker() {
           // basic example
           if ( editor != null ) {
             editor.toggleMarker();
           }
         }

         function changeBGColorAndAlpha() {
           if ( editor != null ) {
             var color_dom = document.getElementById("bg_color");
             var alpha_dom = document.getElementById("bg_alpha");

             editor.setClearColor(parseInt(color_dom.value, 16), parseFloat(alpha_dom.value));
           }
         }

         function shareScene() {
           var address = 'http://yutopp.github.io/PoseEditor/';
           if ( editor != null ) {
             var target = address + '#' + encodeURIComponent(JSON.stringify(editor.getSceneInfo()));

             window.open("https://twitter.com/share?url=" + encodeURIComponent(target) + "&text=PoseEditorでポーズを作ったぞい！");
           }
         }

         $(function() {
           var config = new PoseEditor.Config();
           config.enableBackgroundAlpha = true;
           config.backgroundColorHex = 0x777777;
           config.backgroundAlpha = 1.0;

           editor = new PoseEditor.Editor("for_pose", "models/test05/test05-half.js", "models/test05/", "images/marker.png", config, function() {
             if ( editor ) {
               if ( location.hash !== "" ) {
                 try {
                   var encoded = location.hash.slice(1);
                   var json_string = decodeURIComponent(encoded);

                   editor.loadSceneDataFromString(json_string);

                 } catch(e) {
                   console.warn(e);
                 }
               }
             } else {
               console.warn("editor was not loaded...");
             }
           });
         });
        </script>

        <textarea id="scene_data">{"camera":{"position":{"x":30.579802787793632,"y":-7.989879582550192,"z":37.762911510048916},"quaternion":{"_x":0.07672631711204886,"_y":0.33269925333229955,"_z":-0.02717021269274881,"_w":0.9395137378704318}},"model":{"0":{"rotation":{"_x":0.6822696325990977,"_y":-0.185752127203646,"_z":-0.18576452277611752,"_w":0.6822725538596538}},"1":{"rotation":{"_x":2.11758e-22,"_y":7.54979e-8,"_z":-1,"_w":7.54979e-8}},"2":{"rotation":{"_x":-8.17275e-7,"_y":-1.07068e-13,"_z":-2.34479e-13,"_w":1}},"3":{"rotation":{"_x":5.29881e-7,"_y":7.85681e-14,"_z":1.56319e-13,"_w":1}},"4":{"rotation":{"_x":-0.5,"_y":-0.5,"_z":0.5,"_w":0.5}},"5":{"rotation":{"_x":1.87678e-14,"_y":-4.17233e-7,"_z":-3.05165e-8,"_w":1}},"6":{"rotation":{"_x":-0.6395963342302636,"_y":8.80039490824705e-13,"_z":6.943424214298581e-13,"_w":0.7687109529850663}},"7":{"rotation":{"_x":-0.6259868059451112,"_y":0.0216994272400195,"_z":0.017424159522474232,"_w":0.7793369311825459}},"8":{"rotation":{"_x":-0.5,"_y":0.5,"_z":-0.5,"_w":0.5}},"9":{"rotation":{"_x":6.23945e-15,"_y":4.72869e-7,"_z":6.23031e-8,"_w":1}},"10":{"rotation":{"_x":0.6571119002094387,"_y":-5.545899115733522e-13,"_z":4.820162317744349e-13,"_w":0.7537930422888902}},"11":{"rotation":{"_x":0.667027938219604,"_y":-0.02073050142207008,"_z":0.01856661788310225,"_w":0.7445127645955283}},"12":{"rotation":{"_x":-0.70705,"_y":0.70705,"_z":-0.00892874,"_w":0.0089285}},"13":{"rotation":{"_x":-0.0197262,"_y":0.0197268,"_z":0.706832,"_w":0.706832}},"14":{"rotation":{"_x":0.432029,"_y":-0.00765309,"_z":0.0095325,"_w":0.901777}},"15":{"rotation":{"_x":0.26969,"_y":-0.00670567,"_z":0.00177007,"_w":0.962922}},"16":{"rotation":{"_x":0.855433,"_y":-0.51776,"_z":-0.0108028,"_w":0.00653829}},"17":{"rotation":{"_x":0.3797888810307562,"_y":-0.1931448803846663,"_z":-0.4673542937633728,"_w":0.7746195357254668}},"18":{"rotation":{"_x":-0.432041,"_y":0.00694586,"_z":-0.00523139,"_w":0.901812}},"19":{"rotation":{"_x":-0.00150613,"_y":0.26977,"_z":0.962709,"_w":0.0203317}}}}</textarea>
        <input type="button" value="シーンのロード" onClick="loadSceneData()">
        <input type="button" value="Twitterでシーンを共有" onClick="shareScene()">

        <br>

        <label><input type="radio" name="format" value="png" checked>PNG</label>
        <label><input type="radio" name="format" value="jpeg">JPEG</label>
        <label><input type="radio" name="format" value="json">JSON</label>
        <input type="button" value="ダウンロード" onClick="downloadImage()">

        <br>

        <label><input type="checkbox" id="toggle_marker" onClick="toggleMarker()" checked>マーカー</label>

        <br>

        <label>色<input type="text" id="bg_color" value="0x777777" onChange="changeBGColorAndAlpha()"></label>
        <label>アルファ<input type="text" id="bg_alpha" value="1.0" onChange="changeBGColorAndAlpha<script src="
    </body>
</html>
